import { Button, VerticalBox, HorizontalBox, TabWidget, LineEdit, ProgressIndicator, ScrollView, ComboBox } from "std-widgets.slint";

// ============================================================================
// Theme Colors - Dark cyberpunk with teal accent
// ============================================================================

global Theme {
    // Core background colors
    out property <color> bg-dark: #0a0a0b;
    out property <color> bg-card: #131316;
    out property <color> bg-hover: #1a1a1f;
    out property <color> bg-input: #0d0d0f;
    
    // Border & outline
    out property <color> border: #2a2a30;
    out property <color> border-focus: #00d4aa;
    
    // Text colors
    out property <color> text: #e8e8ed;
    out property <color> text-dim: #8888a0;
    out property <color> text-muted: #5a5a70;
    
    // Accent - teal/cyan
    out property <color> accent: #00d4aa;
    out property <color> accent-glow: #00d4aa40;
    out property <color> accent-text: #0a0a0b;
    
    // Status colors
    out property <color> success: #00d4aa;
    out property <color> error: #ff6b6b;
    out property <color> warning: #ffaa00;
    out property <color> info: #58a6ff;
    
    // Transfer type colors
    out property <color> send-color: #00d4aa;
    out property <color> receive-color: #58a6ff;
    
    // Sizing
    out property <length> radius-sm: 6px;
    out property <length> radius-md: 10px;
    out property <length> radius-lg: 12px;
    out property <length> spacing-xs: 4px;
    out property <length> spacing-sm: 8px;
    out property <length> spacing-md: 12px;
    out property <length> spacing-lg: 16px;
}

// ============================================================================
// Data Structures
// ============================================================================

export struct TransferItem {
    id: string,
    transfer-type: string,
    status: string,
    code: string,
    files: string,
    progress: float,
    speed: string,
    error: string,
}

export struct SelectedFile {
    name: string,
    size: string,
    path: string,
}

export struct AppSettings {
    download-dir: string,
    default-relay: string,
    theme: string,
    croc-path: string,
    croc-found: bool,
}

// ============================================================================
// Application Logic Interface
// ============================================================================

export global AppLogic {
    callback browse-files();
    callback clear-files();
    callback remove-file(int);
    callback start-send();
    callback start-receive(string);
    callback cancel-transfer(string);
    callback copy-code(string);
    callback open-folder(string);
    callback browse-download-dir();
    callback save-settings(string, string, string);
    callback open-config-folder();
    
    in property <[SelectedFile]> selected-files: [];
    in property <[TransferItem]> transfers: [];
    in property <string> app-status: "Ready";
    in property <string> copied-code: "";
    in property <AppSettings> settings: {
        download-dir: "",
        default-relay: "",
        theme: "dark",
        croc-path: "",
        croc-found: false,
    };
}

// ============================================================================
// Compact Button
// ============================================================================

component CompactButton inherits Rectangle {
    in property <string> label;
    in property <bool> primary: false;
    in property <bool> enabled: true;
    in property <string> icon: "";
    callback clicked();
    
    height: 32px;
    min-width: 64px;
    horizontal-stretch: 0;
    border-radius: Theme.radius-sm;
    background: !enabled ? Theme.bg-hover : 
                primary ? (touch.has-hover ? Theme.accent : Theme.accent) :
                touch.has-hover ? Theme.bg-hover : Theme.bg-card;
    border-width: primary ? 0 : 1px;
    border-color: Theme.border;
    opacity: enabled ? 1.0 : 0.5;
    
    touch := TouchArea {
        mouse-cursor: enabled ? pointer : default;
        clicked => { if (enabled) { root.clicked(); } }
    }
    
    HorizontalBox {
        padding-left: 12px;
        padding-right: 12px;
        spacing: 6px;
        alignment: center;
        
        if icon != "": Text {
            text: icon;
            font-size: 12px;
            vertical-alignment: center;
        }
        
        Text {
            text: label;
            font-size: 13px;
            font-weight: 500;
            color: primary ? Theme.accent-text : Theme.text;
            vertical-alignment: center;
        }
    }
}

// ============================================================================
// Icon-only Button
// ============================================================================

component IconBtn inherits Rectangle {
    in property <string> icon;
    in property <color> icon-color: Theme.text-dim;
    callback clicked();
    
    width: 28px;
    height: 28px;
    border-radius: Theme.radius-sm;
    background: touch.has-hover ? Theme.bg-hover : transparent;
    
    touch := TouchArea {
        mouse-cursor: pointer;
        clicked => { root.clicked(); }
    }
    
    Text {
        text: icon;
        font-size: 14px;
        color: touch.has-hover ? Theme.text : icon-color;
        horizontal-alignment: center;
        vertical-alignment: center;
    }
}

// ============================================================================
// Status Badge
// ============================================================================

component StatusBadge inherits Rectangle {
    in property <string> status;
    
    height: 20px;
    border-radius: 3px;
    background: status == "running" ? Theme.accent.with-alpha(0.15) :
                status == "completed" ? Theme.success.with-alpha(0.15) :
                status == "failed" ? Theme.error.with-alpha(0.15) :
                status == "pending" ? Theme.warning.with-alpha(0.15) :
                Theme.bg-hover;
    
    HorizontalBox {
        padding-left: 8px;
        padding-right: 8px;
        spacing: 4px;
        alignment: center;
        
        Rectangle {
            width: 6px;
            height: 6px;
            border-radius: 3px;
            background: status == "running" ? Theme.accent :
                        status == "completed" ? Theme.success :
                        status == "failed" ? Theme.error :
                        status == "pending" ? Theme.warning :
                        Theme.text-dim;
        }
        
        Text {
            text: status == "running" ? "Active" :
                  status == "completed" ? "Done" :
                  status == "failed" ? "Failed" :
                  status == "pending" ? "Waiting" :
                  status == "cancelled" ? "Cancelled" : status;
            font-size: 11px;
            font-weight: 500;
            color: status == "running" ? Theme.accent :
                   status == "completed" ? Theme.success :
                   status == "failed" ? Theme.error :
                   status == "pending" ? Theme.warning :
                   Theme.text-dim;
        }
    }
}

// ============================================================================
// Code Badge (copyable)
// ============================================================================

component CodeBadge inherits Rectangle {
    in property <string> code;
    in property <bool> copied: false;
    callback clicked();
    
    height: 28px;
    border-radius: Theme.radius-sm;
    background: Theme.bg-input;
    border-width: 1px;
    border-color: touch.has-hover ? Theme.accent : Theme.border;
    
    touch := TouchArea {
        mouse-cursor: pointer;
        clicked => { root.clicked(); }
    }
    
    HorizontalBox {
        padding-left: 10px;
        padding-right: 10px;
        spacing: 8px;
        alignment: center;
        
        Text {
            text: code;
            font-size: 13px;
            font-weight: 600;
            color: Theme.accent;
            letter-spacing: 0.5px;
        }
        
        Text {
            text: copied ? "‚úì" : "üìã";
            font-size: 11px;
            color: copied ? Theme.success : Theme.text-dim;
        }
    }
}

// ============================================================================
// File Item (compact)
// ============================================================================

component FileItem inherits Rectangle {
    in property <string> name;
    in property <string> size;
    in property <int> index;
    
    height: 36px;
    background: touch.has-hover ? Theme.bg-hover : transparent;
    border-radius: Theme.radius-sm;
    
    touch := TouchArea {}
    
    HorizontalBox {
        padding-left: 8px;
        padding-right: 4px;
        spacing: 8px;
        
        Text {
            text: "üìÑ";
            font-size: 14px;
            vertical-alignment: center;
        }
        
        Text {
            text: name;
            font-size: 12px;
            color: Theme.text;
            overflow: elide;
            horizontal-stretch: 1;
            vertical-alignment: center;
        }
        
        Text {
            text: size;
            font-size: 11px;
            color: Theme.text-muted;
            vertical-alignment: center;
        }
        
        IconBtn {
            icon: "‚úï";
            icon-color: Theme.text-muted;
            clicked => { AppLogic.remove-file(index); }
        }
    }
}

// ============================================================================
// Transfer Card (compact)
// ============================================================================

component TransferCard inherits Rectangle {
    in property <TransferItem> transfer;
    
    background: Theme.bg-card;
    border-radius: Theme.radius-md;
    border-width: 1px;
    border-color: Theme.border;
    
    VerticalBox {
        padding: Theme.spacing-md;
        spacing: Theme.spacing-sm;
        
        // Header row
        HorizontalBox {
            spacing: Theme.spacing-sm;
            
            // Direction icon
            Rectangle {
                width: 28px;
                height: 28px;
                border-radius: Theme.radius-sm;
                background: transfer.transfer-type == "send" ? Theme.send-color.with-alpha(0.15) : Theme.receive-color.with-alpha(0.15);
                
                Text {
                    text: transfer.transfer-type == "send" ? "‚Üë" : "‚Üì";
                    font-size: 14px;
                    font-weight: 600;
                    color: transfer.transfer-type == "send" ? Theme.send-color : Theme.receive-color;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
            
            // Files & code
            VerticalBox {
                horizontal-stretch: 1;
                spacing: 2px;
                alignment: center;
                
                Text {
                    text: transfer.files;
                    font-size: 12px;
                    font-weight: 500;
                    color: Theme.text;
                    overflow: elide;
                }
                
                if transfer.code != "": HorizontalBox {
                    spacing: 4px;
                    
                    CodeBadge {
                        code: transfer.code;
                        copied: AppLogic.copied-code == transfer.code;
                        clicked => { AppLogic.copy-code(transfer.code); }
                    }
                }
            }
            
            // Status & actions
            HorizontalBox {
                spacing: 6px;
                
                StatusBadge {
                    status: transfer.status;
                }
                
                if transfer.status != "completed" && transfer.status != "failed" && transfer.status != "cancelled": IconBtn {
                    icon: "‚úï";
                    icon-color: Theme.error;
                    clicked => { AppLogic.cancel-transfer(transfer.id); }
                }
                
                if transfer.status == "completed" && transfer.transfer-type == "receive": IconBtn {
                    icon: "üìÇ";
                    clicked => { AppLogic.open-folder(transfer.id); }
                }
            }
        }
        
        // Progress bar
        if transfer.status == "running" || transfer.progress > 0: Rectangle {
            height: 4px;
            border-radius: 2px;
            background: Theme.bg-input;
            
            Rectangle {
                x: 0;
                width: parent.width * (transfer.progress / 100.0);
                height: parent.height;
                border-radius: 2px;
                background: transfer.status == "completed" ? Theme.success :
                            transfer.status == "failed" ? Theme.error :
                            Theme.accent;
            }
        }
        
        // Stats row
        if transfer.status == "running": HorizontalBox {
            spacing: Theme.spacing-lg;
            
            HorizontalBox {
                spacing: 4px;
                
                Text {
                    text: Math.round(transfer.progress) + "%";
                    font-size: 12px;
                    font-weight: 600;
                    color: Theme.accent;
                }
            }
            
            if transfer.speed != "": HorizontalBox {
                spacing: 4px;
                
                Text {
                    text: transfer.speed;
                    font-size: 12px;
                    font-weight: 600;
                    color: Theme.accent;
                }
            }
            
            Rectangle { horizontal-stretch: 1; }
        }
        
        // Error message
        if transfer.status == "failed" && transfer.error != "": Text {
            text: transfer.error;
            font-size: 11px;
            color: Theme.error;
            wrap: word-wrap;
        }
    }
}

// ============================================================================
// Drop Zone
// ============================================================================

component DropZone inherits Rectangle {
    callback clicked();
    
    height: 100px;
    border-radius: Theme.radius-lg;
    border-width: 2px;
    border-color: touch.has-hover ? Theme.accent : Theme.border;
    background: touch.has-hover ? Theme.accent.with-alpha(0.05) : Theme.bg-card;
    
    touch := TouchArea {
        mouse-cursor: pointer;
        clicked => { root.clicked(); }
    }
    
    HorizontalBox {
        alignment: center;
        spacing: Theme.spacing-lg;
        
        Rectangle {
            width: 48px;
            height: 48px;
            border-radius: Theme.radius-md;
            background: Theme.accent.with-alpha(0.1);
            
            Text {
                text: "üìÅ";
                font-size: 24px;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }
        
        VerticalBox {
            alignment: center;
            spacing: 2px;
            
            Text {
                text: "Drop files here";
                font-size: 14px;
                font-weight: 500;
                color: Theme.text;
            }
            
            Text {
                text: "or click to browse";
                font-size: 12px;
                color: Theme.text-dim;
            }
        }
    }
}

// ============================================================================
// Compact Input with Label
// ============================================================================

component LabeledInput inherits Rectangle {
    in property <string> label;
    in property <string> placeholder: "";
    in-out property <string> value;
    
    height: 56px;
    
    VerticalBox {
        spacing: 4px;
        
        Text {
            text: label;
            font-size: 11px;
            font-weight: 500;
            color: Theme.text-dim;
        }
        
        Rectangle {
            height: 36px;
            border-radius: Theme.radius-sm;
            background: Theme.bg-input;
            border-width: 1px;
            border-color: input.has-focus ? Theme.accent : Theme.border;
            
            input := LineEdit {
                text <=> value;
                placeholder-text: placeholder;
                font-size: 13px;
            }
        }
    }
}

// ============================================================================
// Setting Row (compact)
// ============================================================================

component SettingRow inherits Rectangle {
    in property <string> label;
    in property <string> sublabel: "";
    
    height: sublabel == "" ? 40px : 52px;
    
    HorizontalBox {
        padding: Theme.spacing-sm;
        spacing: Theme.spacing-md;
        
        VerticalBox {
            horizontal-stretch: 1;
            alignment: center;
            spacing: 2px;
            
            Text {
                text: label;
                font-size: 13px;
                color: Theme.text;
            }
            
            if sublabel != "": Text {
                text: sublabel;
                font-size: 11px;
                color: Theme.text-muted;
                overflow: elide;
            }
        }
        
        @children
    }
}

// ============================================================================
// Section Card
// ============================================================================

component Section inherits Rectangle {
    in property <string> title: "";
    
    background: Theme.bg-card;
    border-radius: Theme.radius-md;
    border-width: 1px;
    border-color: Theme.border;
    
    VerticalBox {
        padding: Theme.spacing-md;
        spacing: Theme.spacing-sm;
        
        if title != "": HorizontalBox {
            height: 20px;
            
            Text {
                text: title;
                font-size: 11px;
                font-weight: 600;
                color: Theme.accent;
                letter-spacing: 0.5px;
            }
        }
        
        @children
    }
}

// ============================================================================
// Pill Tab Selector
// ============================================================================

component PillTabs inherits Rectangle {
    in property <[string]> tabs;
    in-out property <int> current: 0;
    callback changed(int);
    
    height: 40px;
    background: Theme.bg-card;
    border-radius: Theme.radius-md;
    border-width: 1px;
    border-color: Theme.border;
    
    HorizontalBox {
        padding: 4px;
        spacing: 4px;
        
        for tab[i] in tabs: Rectangle {
            horizontal-stretch: 1;
            border-radius: Theme.radius-sm;
            background: i == current ? Theme.accent : 
                        pill-touch.has-hover ? Theme.bg-hover : transparent;
            
            pill-touch := TouchArea {
                mouse-cursor: pointer;
                clicked => {
                    current = i;
                    changed(i);
                }
            }
            
            Text {
                text: tab;
                font-size: 13px;
                font-weight: 500;
                color: i == current ? Theme.accent-text : Theme.text-dim;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }
    }
}

// ============================================================================
// Send Panel
// ============================================================================

component SendPanel inherits Rectangle {
    background: Theme.bg-dark;
    
    VerticalBox {
        padding: Theme.spacing-lg;
        spacing: Theme.spacing-md;
        
        DropZone {
            clicked => { AppLogic.browse-files(); }
        }
        
        // Selected files
        if AppLogic.selected-files.length > 0: Section {
            vertical-stretch: 1;
            
            HorizontalBox {
                height: 24px;
                
                Text {
                    text: "Selected";
                    font-size: 12px;
                    font-weight: 500;
                    color: Theme.text;
                    horizontal-stretch: 1;
                }
                
                Rectangle {
                    width: 20px;
                    height: 20px;
                    border-radius: 10px;
                    background: Theme.accent;
                    
                    Text {
                        text: AppLogic.selected-files.length;
                        font-size: 11px;
                        font-weight: 600;
                        color: Theme.accent-text;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
            }
            
            ScrollView {
                vertical-stretch: 1;
                
                VerticalBox {
                    spacing: 2px;
                    
                    for file[i] in AppLogic.selected-files: FileItem {
                        name: file.name;
                        size: file.size;
                        index: i;
                    }
                }
            }
            
            HorizontalBox {
                spacing: Theme.spacing-sm;
                
                CompactButton {
                    label: "Clear";
                    clicked => { AppLogic.clear-files(); }
                }
                
                Rectangle { horizontal-stretch: 1; }
                
                CompactButton {
                    label: "Send";
                    icon: "üöÄ";
                    primary: true;
                    enabled: AppLogic.selected-files.length > 0;
                    clicked => { AppLogic.start-send(); }
                }
            }
        }
        
        if AppLogic.selected-files.length == 0: Rectangle {
            vertical-stretch: 1;
            background: transparent;
        }
    }
}

// ============================================================================
// Receive Panel
// ============================================================================

component ReceivePanel inherits Rectangle {
    in-out property <string> code: "";
    
    background: Theme.bg-dark;
    
    VerticalBox {
        padding: Theme.spacing-lg;
        spacing: Theme.spacing-md;
        
        Section {
            VerticalBox {
                spacing: Theme.spacing-md;
                
                LabeledInput {
                    label: "TRANSFER CODE";
                    placeholder: "e.g. 7-alpha-beta-gamma";
                    value <=> code;
                }
                
                HorizontalBox {
                    Rectangle { horizontal-stretch: 1; }
                    
                    CompactButton {
                        label: "Receive";
                        icon: "üì•";
                        primary: true;
                        enabled: code != "";
                        clicked => { 
                            AppLogic.start-receive(code);
                            code = "";
                        }
                    }
                }
            }
        }
        
        Rectangle { vertical-stretch: 1; }
    }
}

// ============================================================================
// Peers Panel
// ============================================================================

component PeersPanel inherits Rectangle {
    background: Theme.bg-dark;
    
    VerticalBox {
        padding: Theme.spacing-lg;
        spacing: Theme.spacing-md;
        
        Section {
            vertical-stretch: 1;
            
            VerticalBox {
                alignment: center;
                spacing: Theme.spacing-md;
                
                Rectangle {
                    width: 56px;
                    height: 56px;
                    border-radius: 28px;
                    background: Theme.accent.with-alpha(0.1);
                    
                    Text {
                        text: "üë•";
                        font-size: 28px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
                
                Text {
                    text: "Trusted Peers";
                    font-size: 14px;
                    font-weight: 500;
                    color: Theme.text;
                    horizontal-alignment: center;
                }
                
                Text {
                    text: "P2P connections coming soon";
                    font-size: 12px;
                    color: Theme.text-dim;
                    horizontal-alignment: center;
                }
            }
        }
    }
}

// ============================================================================
// Settings Panel
// ============================================================================

component SettingsPanel inherits Rectangle {
    in-out property <string> download-dir: AppLogic.settings.download-dir;
    in-out property <string> relay: AppLogic.settings.default-relay;
    in-out property <int> theme-idx: AppLogic.settings.theme == "light" ? 1 : AppLogic.settings.theme == "dark" ? 2 : 0;
    
    background: Theme.bg-dark;
    
    ScrollView {
        VerticalBox {
            padding: Theme.spacing-lg;
            spacing: Theme.spacing-md;
            
            // Downloads
            Section {
                title: "DOWNLOADS";
                
                SettingRow {
                    label: "Save Location";
                    sublabel: download-dir == "" ? "Default system downloads" : download-dir;
                    
                    CompactButton {
                        label: "Browse";
                        clicked => { AppLogic.browse-download-dir(); }
                    }
                }
            }
            
            // Network
            Section {
                title: "NETWORK";
                
                SettingRow {
                    label: "Custom Relay";
                    sublabel: "Leave empty for default";
                    
                    Rectangle {
                        width: 160px;
                        height: 28px;
                        border-radius: Theme.radius-sm;
                        background: Theme.bg-input;
                        border-width: 1px;
                        border-color: Theme.border;
                        
                        LineEdit {
                            text <=> relay;
                            placeholder-text: "relay.example.com";
                            font-size: 12px;
                        }
                    }
                }
            }
            
            // Appearance
            Section {
                title: "APPEARANCE";
                
                SettingRow {
                    label: "Theme";
                    
                    ComboBox {
                        width: 100px;
                        model: ["System", "Light", "Dark"];
                        current-index <=> theme-idx;
                    }
                }
            }
            
            // About
            Section {
                title: "ABOUT";
                
                SettingRow {
                    label: "Croc";
                    sublabel: AppLogic.settings.croc-found ? AppLogic.settings.croc-path : "Not found";
                    
                    Rectangle {
                        width: 8px;
                        height: 8px;
                        border-radius: 4px;
                        background: AppLogic.settings.croc-found ? Theme.success : Theme.error;
                    }
                }
                
                SettingRow {
                    label: "Version";
                    sublabel: "Croc GUI v0.1.0";
                    
                    CompactButton {
                        label: "Config";
                        clicked => { AppLogic.open-config-folder(); }
                    }
                }
            }
            
            // Save
            HorizontalBox {
                Rectangle { horizontal-stretch: 1; }
                
                CompactButton {
                    label: "Save Settings";
                    primary: true;
                    clicked => {
                        AppLogic.save-settings(
                            download-dir,
                            relay,
                            theme-idx == 0 ? "system" : theme-idx == 1 ? "light" : "dark"
                        );
                    }
                }
            }
        }
    }
}

// ============================================================================
// Transfers Panel (bottom bar)
// ============================================================================

component TransfersBar inherits Rectangle {
    background: Theme.bg-card;
    
    VerticalBox {
        padding: Theme.spacing-sm;
        spacing: Theme.spacing-sm;
        
        // Header
        HorizontalBox {
            height: 24px;
            padding-left: Theme.spacing-sm;
            padding-right: Theme.spacing-sm;
            
            Text {
                text: "Transfers";
                font-size: 12px;
                font-weight: 600;
                color: Theme.text;
                vertical-alignment: center;
            }
            
            Rectangle { horizontal-stretch: 1; }
            
            if AppLogic.transfers.length > 0: Rectangle {
                width: 18px;
                height: 18px;
                border-radius: 9px;
                background: Theme.accent;
                
                Text {
                    text: AppLogic.transfers.length;
                    font-size: 10px;
                    font-weight: 600;
                    color: Theme.accent-text;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
        }
        
        // Content
        if AppLogic.transfers.length == 0: Rectangle {
            height: 32px;
            
            Text {
                text: "No active transfers";
                font-size: 12px;
                color: Theme.text-muted;
                horizontal-alignment: center;
                vertical-alignment: center;
            }
        }
        
        // Transfer list
        ScrollView {
            vertical-stretch: 1;
            
            VerticalBox {
                spacing: Theme.spacing-sm;
                
                for transfer in AppLogic.transfers: TransferCard {
                    transfer: transfer;
                }
            }
        }
    }
}

// ============================================================================
// Main Window
// ============================================================================

export component MainWindow inherits Window {
    title: "Croc";
    min-width: 480px;
    min-height: 400px;
    preferred-width: 600px;
    preferred-height: 500px;
    background: Theme.bg-dark;
    
    property <int> active-tab: 0;
    
    VerticalBox {
        spacing: 0;
        
        // Header
        Rectangle {
            height: 44px;
            background: Theme.bg-card;
            border-color: Theme.border;
            
            HorizontalBox {
                padding-left: 16px;
                padding-right: 16px;
                spacing: 10px;
                
                // Logo
                Rectangle {
                    width: 32px;
                    height: 32px;
                    border-radius: Theme.radius-sm;
                    background: Theme.accent;
                    
                    Text {
                        text: "üêä";
                        font-size: 18px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                }
                
                Text {
                    text: "Croc";
                    font-size: 18px;
                    font-weight: 600;
                    color: Theme.text;
                    vertical-alignment: center;
                }
                
                Rectangle { horizontal-stretch: 1; }
                
                // Status badge
                Rectangle {
                    height: 24px;
                    border-radius: Theme.radius-sm;
                    background: Theme.bg-hover;
                    
                    HorizontalBox {
                        padding-left: 8px;
                        padding-right: 8px;
                        
                        Text {
                            text: AppLogic.app-status;
                            font-size: 11px;
                            color: Theme.text-dim;
                            vertical-alignment: center;
                        }
                    }
                }
            }
        }
        
        // Tabs
        Rectangle {
            height: 48px;
            background: Theme.bg-dark;
            
            HorizontalBox {
                padding: 4px;
                padding-left: 12px;
                padding-right: 12px;
                
                PillTabs {
                    tabs: ["Send", "Receive", "Peers", "Settings"];
                    current <=> active-tab;
                }
            }
        }
        
        // Content
        Rectangle {
            vertical-stretch: 1;
            
            if active-tab == 0: SendPanel {}
            if active-tab == 1: ReceivePanel {}
            if active-tab == 2: PeersPanel {}
            if active-tab == 3: SettingsPanel {}
        }
        
        // Transfers bar
        TransfersBar {
            min-height: 80px;
            max-height: 180px;
        }
    }
}
